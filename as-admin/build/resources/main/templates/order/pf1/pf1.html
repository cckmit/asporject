<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('PF1订单查询列表')" />
</head>
<body class="gray-bg">
     <div class="container-div">
        <div class="row">
            <div class="col-sm-12 search-collapse">
                <form id="form-pf1-order" class="form-horizontal">
                    <h4 class="form-header h4">[[#{pf1.order.query}]]</h4>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">[[#{pf1.order.number}]]：</label>
                                <div class="col-sm-4">
                                    <input class="form-control" type="text" name="orderNo"/>
                                </div>
                                <div class="col-sm-4">
                                    <a class="btn btn-primary btn-rounded btn-sm" onclick="tableSearch()">
                                        <i class="fa fa-search"></i> [[#{db.query.query}]]
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-sm-12 select-table table-bordered">
                <table id="bootstrap-table"></table>
            </div>
        </div>
    </div>
    <th:block th:include="include :: footer" />
     <th:block th:include="include :: bootstrap-table-export-js" />
     <script type="text/javascript">
        var prefix = ctx + "order/pf1";

        function initTable(){
            var options = {
                url: prefix + "/list",
                firstLoad:false,
                showExport: true,
                pagination: false,
                striped: true,
                headerStyle: headerStyle,
                modalName: i18n('pf1.order.query'),
                columns: [
                        [{
                            title : i18n('pf1.order.content'),
                            align : 'center',
                            field: '',
                            colspan : 3
                        }
                    ],
                    [{
                            field: 'columnName',
                            title: i18n('pf1.order.field.name'),
                            halign: 'center'
                        },
                        {
                            field: 'dbValue',
                            title: i18n('pf1.order.db.value'),
                            halign: 'center'
                        },
                        {
                            field: 'logValue',
                            title: i18n('pf1.order.log.value'),
                            halign: 'center'
                        }
                    ]
                ]
            };
            $.table.init(options);
        }


        $("#form-pf1-order").validate({
            onkeyup: false,
            rules:{
                orderNo:{
                    required:true,
                    isOrder:true
                },
            },
            focusCleanup: true
        });
        // 搜索
        function tableSearch(){
            if ($.validate.form()){
                if(!table.get(table.options.id)){
                    initTable();
                    refreshTable();
                } else {
                    refreshTable();
                }
            }
        }
        // 刷新表格
        function refreshTable() {
            $("#" + table.options.id).bootstrapTable('refreshOptions',table.options);
        }

        function headerStyle(column) {
            return {
                '': {
                    css: { background: '#3c8dbc','font-size': '22px',color:'white','font-weight': 'bolder' }
                },
                columnName:{
                    css: { background: '#3c8dbc','font-size': '17px',color:'white','font-weight': 'bold' }
                },
                dbValue:{
                    css: { background: '#3c8dbc','font-size': '17px',color:'white','font-weight': 'bold' }
                },
                logValue:{
                    css: { background: '#3c8dbc','font-size': '17px',color:'white','font-weight': 'bold' }
                },
            }[column.field]
        }
    </script>
</body>
</html>