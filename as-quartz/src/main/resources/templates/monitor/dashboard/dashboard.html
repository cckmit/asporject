<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('仪表盘')"/>
    <th:block th:include="include :: bootstrap-switch-css"/>
</head>
<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <div class="row">
                        <div class="col-sm-6">
                            <h1><i class="fa fa-desktop"></i> [[#{monitor.dashboard}]]</h1>
                        </div>
                        <div class="col-sm-6">
                            <button id="switchButton" class="btn btn-danger dim pull-right" type="button"><i class="fa fa-bell-o"></i></button>
                        </div>
                    </div>
                </div>
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <div class="col-sm-12 select-table table-bordered">
                                    <div class="pull-right" id="toolbarSql" role="group">
                                        <label class="label">[[#{monitor.auto.refresh}]]：</label>
                                        <input type="checkbox" data-size="mini" id="suspendRefreshSql">
                                        <label class="label">[[#{monitor.auto.refresh.time}]]：</label>
                                        <select id="selectTimeSql"
                                                style="width:50px;padding:0px 10px;appearance:none;-moz-appearance:none;-webkit-appearance:none;
                                    background:url(data:image/jpg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QMraHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE3MDBDMTIwOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjE3MDBDMTIxOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTcwMEMxMUU4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MTcwMEMxMUY4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAAGBAQEBQQGBQUGCQYFBgkLCAYGCAsMCgoLCgoMEAwMDAwMDBAMDg8QDw4MExMUFBMTHBsbGxwfHx8fHx8fHx8fAQcHBw0MDRgQEBgaFREVGh8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx//wAARCAAyAB4DAREAAhEBAxEB/8QAbgABAQEBAQEAAAAAAAAAAAAABAAHBgUIAQEBAAMAAAAAAAAAAAAAAAAAAwECBBAAAgEDAQYFBQAAAAAAAAAAAQIAAwQFETGyczUGByFhEhMjUTJyYxQRAQADAQEAAAAAAAAAAAAAAAABEQIDMf/aAAwDAQACEQMRAD8A+i8dy+24SbogIgUCgHx3L7bhJuiAiBQKAS0R3xVFEqGk7UFC1VAJUlAAwDArqPMQMA6h7j91MFmbvFXmW0rWrlfV/NagMu1XHxbGUgidEYzMOTXTUTTt+0Gf686juLnI5jImriLYe0lL2aCe7WI1+5Katoi+J0O0jzmnSIjxXlrU+tTklh8dy+24SbogZ93e7d3HUa2WRxVMHJ0nS3rDZ6qFRtAxP6mOv4k/SU57pHrzvx2/TmCs8DhbTFWg+G2QKX00LufF3PmzEmaTNyrnNRT0phkfHcvtuEm6ICIFAoB8dy+24SbogIgUCgHx3L7bhJuiAiBQKB//2Q0K)
                                    no-repeat right center;background-color: #eee;background-size:20%;" required>
                                            <option value="5">5s</option>
                                            <option value="10">10s</option>
                                            <option value="20">20s</option>
                                            <option value="30" selected>30s</option>
                                            <option value="60">60s</option>
                                        </select>
                                    </div>
                                    <table id="bootstrap-table-sql"></table>
                                    <div id="sql-update-time" class="badge badge-success pull-right" style="margin-top: 10px"><span class="title">[[#{common.last.update.time}]]：</span><span class="time"></span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <div class="col-sm-12 select-table table-bordered">
                                    <div class="pull-right" id="toolbarElastic" role="group">
                                        <label class="label">[[#{monitor.auto.refresh}]]：</label>
                                        <input type="checkbox" data-size="mini" id="suspendRefreshElastic">
                                        <label class="label">[[#{monitor.auto.refresh.time}]]：</label>
                                        <select id="selectTimeElastic"
                                                style="width:50px;padding:0px 10px;appearance:none;-moz-appearance:none;-webkit-appearance:none;
                                    background:url(data:image/jpg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QMraHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE3MDBDMTIwOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjE3MDBDMTIxOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTcwMEMxMUU4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MTcwMEMxMUY4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAAGBAQEBQQGBQUGCQYFBgkLCAYGCAsMCgoLCgoMEAwMDAwMDBAMDg8QDw4MExMUFBMTHBsbGxwfHx8fHx8fHx8fAQcHBw0MDRgQEBgaFREVGh8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx//wAARCAAyAB4DAREAAhEBAxEB/8QAbgABAQEBAQEAAAAAAAAAAAAABAAHBgUIAQEBAAMAAAAAAAAAAAAAAAAAAwECBBAAAgEDAQYFBQAAAAAAAAAAAQIAAwQFETGyczUGByFhEhMjUTJyYxQRAQADAQEAAAAAAAAAAAAAAAABEQIDMf/aAAwDAQACEQMRAD8A+i8dy+24SbogIgUCgHx3L7bhJuiAiBQKAS0R3xVFEqGk7UFC1VAJUlAAwDArqPMQMA6h7j91MFmbvFXmW0rWrlfV/NagMu1XHxbGUgidEYzMOTXTUTTt+0Gf686juLnI5jImriLYe0lL2aCe7WI1+5Katoi+J0O0jzmnSIjxXlrU+tTklh8dy+24SbogZ93e7d3HUa2WRxVMHJ0nS3rDZ6qFRtAxP6mOv4k/SU57pHrzvx2/TmCs8DhbTFWg+G2QKX00LufF3PmzEmaTNyrnNRT0phkfHcvtuEm6ICIFAoB8dy+24SbogIgUCgHx3L7bhJuiAiBQKB//2Q0K)
                                    no-repeat right center;background-color: #eee;background-size:20%;" required>
                                            <option value="5">5s</option>
                                            <option value="10">10s</option>
                                            <option value="20">20s</option>
                                            <option value="30" selected>30s</option>
                                            <option value="60">60s</option>
                                        </select>
                                    </div>
                                    <table id="bootstrap-table-elastic"></table>
                                    <div id="elastic-update-time" class="badge badge-success pull-right" style="margin-top: 10px"><span class="title">[[#{common.last.update.time}]]：</span><span class="time"></span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <div class="col-sm-12 select-table table-bordered">
                                    <div class="pull-right" id="toolbarApi" role="group">
                                        <label class="label">[[#{monitor.auto.refresh}]]：</label>
                                        <input type="checkbox" data-size="mini" id="suspendRefreshApi">
                                        <label class="label">[[#{monitor.auto.refresh.time}]]：</label>
                                        <select id="selectTimeApi"
                                                style="width:50px;padding:0px 10px;appearance:none;-moz-appearance:none;-webkit-appearance:none;
                                    background:url(data:image/jpg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QMraHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE3MDBDMTIwOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjE3MDBDMTIxOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTcwMEMxMUU4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MTcwMEMxMUY4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAAGBAQEBQQGBQUGCQYFBgkLCAYGCAsMCgoLCgoMEAwMDAwMDBAMDg8QDw4MExMUFBMTHBsbGxwfHx8fHx8fHx8fAQcHBw0MDRgQEBgaFREVGh8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx//wAARCAAyAB4DAREAAhEBAxEB/8QAbgABAQEBAQEAAAAAAAAAAAAABAAHBgUIAQEBAAMAAAAAAAAAAAAAAAAAAwECBBAAAgEDAQYFBQAAAAAAAAAAAQIAAwQFETGyczUGByFhEhMjUTJyYxQRAQADAQEAAAAAAAAAAAAAAAABEQIDMf/aAAwDAQACEQMRAD8A+i8dy+24SbogIgUCgHx3L7bhJuiAiBQKAS0R3xVFEqGk7UFC1VAJUlAAwDArqPMQMA6h7j91MFmbvFXmW0rWrlfV/NagMu1XHxbGUgidEYzMOTXTUTTt+0Gf686juLnI5jImriLYe0lL2aCe7WI1+5Katoi+J0O0jzmnSIjxXlrU+tTklh8dy+24SbogZ93e7d3HUa2WRxVMHJ0nS3rDZ6qFRtAxP6mOv4k/SU57pHrzvx2/TmCs8DhbTFWg+G2QKX00LufF3PmzEmaTNyrnNRT0phkfHcvtuEm6ICIFAoB8dy+24SbogIgUCgHx3L7bhJuiAiBQKB//2Q0K)
                                    no-repeat right center;background-color: #eee;background-size:20%;" required>
                                            <option value="5">5s</option>
                                            <option value="10">10s</option>
                                            <option value="20">20s</option>
                                            <option value="30" selected>30s</option>
                                            <option value="60">60s</option>
                                        </select>
                                    </div>
                                    <table id="bootstrap-table-api"></table>
                                    <div id="api-update-time" class="badge badge-success pull-right" style="margin-top: 10px"><span class="title">[[#{common.last.update.time}]]：</span><span class="time"></span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <div class="col-sm-12 select-table table-bordered">
                                    <div class="pull-right" id="toolbarExport" role="group">
                                        <label class="label">[[#{monitor.auto.refresh}]]：</label>
                                        <input type="checkbox" data-size="mini" id="suspendRefreshExport">
                                        <label class="label">[[#{monitor.auto.refresh.time}]]：</label>
                                        <select id="selectTimeExport"
                                                style="width:50px;padding:0px 10px;appearance:none;-moz-appearance:none;-webkit-appearance:none;
                                    background:url(data:image/jpg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QMraHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE3MDBDMTIwOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjE3MDBDMTIxOEM1RjExRTY5OURFQjNEMzU1OTYzQzczIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTcwMEMxMUU4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MTcwMEMxMUY4QzVGMTFFNjk5REVCM0QzNTU5NjNDNzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAAGBAQEBQQGBQUGCQYFBgkLCAYGCAsMCgoLCgoMEAwMDAwMDBAMDg8QDw4MExMUFBMTHBsbGxwfHx8fHx8fHx8fAQcHBw0MDRgQEBgaFREVGh8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx//wAARCAAyAB4DAREAAhEBAxEB/8QAbgABAQEBAQEAAAAAAAAAAAAABAAHBgUIAQEBAAMAAAAAAAAAAAAAAAAAAwECBBAAAgEDAQYFBQAAAAAAAAAAAQIAAwQFETGyczUGByFhEhMjUTJyYxQRAQADAQEAAAAAAAAAAAAAAAABEQIDMf/aAAwDAQACEQMRAD8A+i8dy+24SbogIgUCgHx3L7bhJuiAiBQKAS0R3xVFEqGk7UFC1VAJUlAAwDArqPMQMA6h7j91MFmbvFXmW0rWrlfV/NagMu1XHxbGUgidEYzMOTXTUTTt+0Gf686juLnI5jImriLYe0lL2aCe7WI1+5Katoi+J0O0jzmnSIjxXlrU+tTklh8dy+24SbogZ93e7d3HUa2WRxVMHJ0nS3rDZ6qFRtAxP6mOv4k/SU57pHrzvx2/TmCs8DhbTFWg+G2QKX00LufF3PmzEmaTNyrnNRT0phkfHcvtuEm6ICIFAoB8dy+24SbogIgUCgHx3L7bhJuiAiBQKB//2Q0K)
                                    no-repeat right center;background-color: #eee;background-size:20%;" required>
                                            <option value="5">5s</option>
                                            <option value="10">10s</option>
                                            <option value="20">20s</option>
                                            <option value="30" selected>30s</option>
                                            <option value="60">60s</option>
                                        </select>
                                    </div>
                                    <table id="bootstrap-table-export"></table>
                                    <div id="export-update-time" class="badge badge-success pull-right" style="margin-top: 10px"><span class="title">[[#{common.last.update.time}]]：</span><span class="time"></span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                </div>
            </div>
        </div>
    </div>
</div>

<audio id="alarmSound" style="margin:0; display:none;" loop>
    <source th:src="'/music/Gold-PLease_' + #{locale} +'.mp3'" type="audio/mpeg"/>
</audio>

<th:block th:include="include :: footer"/>
<th:block th:include="include :: bootstrap-table-switch-js" />
<script th:inline="javascript">
    var statusDatas = [[${@dict.getType('sys_common_status')}]];
    var PLATFORMDatas = [[${@dict.getType('ub8_platform_type')}]];
    var prefix = ctx + "monitor/dashboard";

    var sqloptions;
    var elasticoptions;
    var apioptions;
    var exportoptions;

    function checkAlert(){
        if (isSwitchOn()){
            var switchOnNum = $("table .fa-toggle-on").length
            if (switchOnNum > 0){
                if (isPaused()){
                    play()
                }
            } else if (!isPaused()){
                pause()
            }
        }
    }

    function play(){
        document.getElementById("alarmSound").play();
    }

    //      暫停播放音效
    function pause(){
        document.getElementById("alarmSound").pause();
    }

    //      是否播放音效中
    function isPaused(){
        return document.getElementById("alarmSound").paused;
    }

    //      打開開關
    function switchOn(){
        $("#switchButton").html('<i class="fa fa-bell-o"></i>');
        checkAlert()
    }

    //      關閉開關
    function switchOff(){
        $("#switchButton").html('<i class="fa fa-bell-slash-o"></i>');
        checkAlert()
    }

    function isSwitchOn(){
        return $("#switchButton").html() === '<i class="fa fa-bell-o"></i>';
    }

    function sqlLastUpdateTime(){
        checkAlert()
        $("#sql-update-time .time").text($.common.dateFormat(new Date(),'yyyy-MM-dd HH:mm:ss'));
    }
    function exportLastUpdateTime(){
        checkAlert()
        $("#export-update-time .time").text($.common.dateFormat(new Date(),'yyyy-MM-dd HH:mm:ss'));
    }
    function elasticLastUpdateTime(){
        checkAlert()
        $("#elastic-update-time .time").text($.common.dateFormat(new Date(),'yyyy-MM-dd HH:mm:ss'));
    }
    function apiLastUpdateTime(){
        checkAlert()
        $("#api-update-time .time").text($.common.dateFormat(new Date(),'yyyy-MM-dd HH:mm:ss'));
    }

    $(document).ready(function(){
        $("#switchButton").bind("click", function(){
            if(isSwitchOn()){
                switchOff();
            }else{
                switchOn();
            }
            if(isSwitchOn()){
                checkAlert();
            }else{
                if (!isPaused()){
                    pause()
                }
            }
        });
    });

    $(function(){
        var options = {
            url: prefix + "/updateSqlJob",
            detailUrl: ctx + 'monitor/sqlJobLog/detail/{id}"',
            id:'bootstrap-table-sql',
            toolbar:'toolbarSql',
            pagination: false,
            striped: true,
            showSearch: false,
            showRefresh: false,
            showToggle: false,
            showColumns: false,
            onLoadSuccess: sqlLastUpdateTime,
            headerStyle: headerStyle,
            onClickCell: onClickSqlCell,
            modalName: i18n('sql.job.sql.task'),
            columns: [
                [{
                    title : i18n('sql.job.sql.task'),
                    align : 'center',
                    field: '',
                    colspan : 7
                }
                ],
                [{
                    field: 'startTime',
                    title: i18n('common.start.time'),
                    align: 'center',
                    cellStyle: {
                        css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                    }
                },
                    {
                        field: 'moniJob.chName',
                        title: i18n('sql.job.name_zh'),
                        visible: i18n('locale') !== 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniJob.enName',
                        title: i18n('sql.job.name_en'),
                        visible: i18n('locale') === 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniJob.platform',
                        title: i18n('sql.job.platform'),
                        formatter: function (value, row, index) {
                            return $.table.selectDictLabel(PLATFORMDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        field: 'status',
                        title: i18n('sql.job.execute.status'),
                        formatter: function(value, row, index) {
                            return $.table.selectDictLabel(statusDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        field: 'alertStatus',
                        title: i18n('monitor.alert.switch'),
                        align: 'center',
                        formatter: function (value, row, index) {
                            return sqlJobAlertTools(row);
                        },
                    },
                    {
                        field: 'callback',
                        title: i18n('sql.job.log.callback'),
                        align: 'center',
                        formatter: function(value, row, index) {
                            var actions = [];
                            actions.push('<a class="btn btn-primary btn-xs" href="javascript:void(0)" onclick="callbackSql(\'' + row.id + '\')"><i class="fa fa-check"></i></a>');
                            return actions.join('');
                        }
                    }
                ]
            ]
        };
        $.table.init(options);
        sqloptions = options;
    })

    $(function(){
        var options = {
            url: prefix + "/updateExportJob",
            id:'bootstrap-table-export',
            toolbar:'toolbarExport',
            pagination: false,
            striped: true,
            showSearch: false,
            showRefresh: false,
            showToggle: false,
            showColumns: false,
            headerStyle: headerStyle,
            onLoadSuccess: exportLastUpdateTime,
            modalName: i18n('export.job'),
            columns: [
                [{
                    title : i18n('export.job'),
                    align : 'center',
                    field: '',
                    colspan : 7
                }
                ],
                [{
                    field: 'startTime',
                    title: i18n('common.start.time'),
                    align: 'center',
                    cellStyle: {
                        css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                    }
                },
                    {
                        field: 'moniExport.ticketNumber',
                        title: 'Ticket Number',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniExport.chName',
                        title: i18n('sql.job.name_zh'),
                        visible: i18n('locale') !== 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniExport.enName',
                        title: i18n('sql.job.name_en'),
                        visible: i18n('locale') === 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniExport.platform',
                        title: i18n('sql.job.platform'),
                        formatter: function (value, row, index) {
                            return $.table.selectDictLabel(PLATFORMDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        field: 'status',
                        title: i18n('sql.job.execute.status'),
                        formatter: function(value, row, index) {
                            return $.table.selectDictLabel(statusDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        title: i18n('sql.job.log.callback'),
                        align: 'center',
                        formatter: function(value, row, index) {
                            var actions = [];
                            actions.push('<a class="btn btn-primary btn-xs" href="javascript:void(0)" onclick="callbackExport(\'' + row.id + '\')"><i class="fa fa-check"></i></a>');
                            return actions.join('');
                        }
                    }
                ]
            ]
        };
        $.table.init(options);
        exportoptions = options;
    })


    $(function(){
        var options = {
            url: prefix + "/updateApiJob",
            id:'bootstrap-table-api',
            toolbar:'toolbarApi',
            pagination: false,
            striped: true,
            showSearch: false,
            showRefresh: false,
            showToggle: false,
            showColumns: false,
            headerStyle: headerStyle,
            onLoadSuccess: apiLastUpdateTime,
            modalName: i18n('api.job'),
            columns: [
                [{
                    title : i18n('api.job'),
                    align : 'center',
                    field: '',
                    colspan : 7
                }
                ],
                [{
                    field: 'startTime',
                    title: i18n('common.start.time'),
                    align: 'center',
                    cellStyle: {
                        css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                    }
                },
                    {
                        field: 'moniApi.chName',
                        title: i18n('sql.job.name_zh'),
                        visible: i18n('locale') !== 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniApi.enName',
                        title: i18n('sql.job.name_en'),
                        visible: i18n('locale') === 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniApi.platform',
                        title: i18n('sql.job.platform'),
                        formatter: function (value, row, index) {
                            return $.table.selectDictLabel(PLATFORMDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        field: 'status',
                        title: i18n('sql.job.execute.status'),
                        formatter: function(value, row, index) {
                            return $.table.selectDictLabel(statusDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        field: 'alertStatus',
                        title: i18n('monitor.alert.switch'),
                        align: 'center',
                        formatter: function (value, row, index) {
                            return apiJobAlertTools(row);
                        },
                    },
                    {
                        title: i18n('sql.job.log.callback'),
                        align: 'center',
                        formatter: function(value, row, index) {
                            var actions = [];
                            actions.push('<a class="btn btn-primary btn-xs" href="javascript:void(0)" onclick="callbackApi(\'' + row.id + '\')"><i class="fa fa-check"></i></a>');
                            return actions.join('');
                        }
                    }
                ]
            ]
        };
        $.table.init(options);
        apioptions = options;
    })

    $(function(){
        var options = {
            url: prefix + "/updateElasticJob",
            id:'bootstrap-table-elastic',
            toolbar:'toolbarElastic',
            pagination: false,
            striped: true,
            showSearch: false,
            showRefresh: false,
            showToggle: false,
            showColumns: false,
            headerStyle: headerStyle,
            onLoadSuccess: elasticLastUpdateTime,
            modalName: i18n('elastic.job'),
            columns: [
                [{
                    title : i18n('elastic.job'),
                    align : 'center',
                    field: '',
                    colspan : 7
                }
                ],
                [{
                    field: 'startTime',
                    title: i18n('common.start.time'),
                    align: 'center',
                    cellStyle: {
                        css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                    }
                },
                    {
                        field: 'moniElastic.chName',
                        title: i18n('sql.job.name_zh'),
                        visible: i18n('locale') !== 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniElastic.enName',
                        title: i18n('sql.job.name_en'),
                        visible: i18n('locale') === 'en-US',
                        align: 'center',
                        cellStyle: {
                            css:{"background-color":"rgba(220,38,38,0.2)","font-weight": 700,"color":"red"}
                        }
                    },
                    {
                        field: 'moniElastic.platform',
                        title: i18n('sql.job.platform'),
                        formatter: function (value, row, index) {
                            return $.table.selectDictLabel(PLATFORMDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        field: 'status',
                        title: i18n('sql.job.execute.status'),
                        formatter: function(value, row, index) {
                            return $.table.selectDictLabel(statusDatas, value);
                        },
                        align: 'center',
                    },
                    {
                        field: 'alertStatus',
                        title: i18n('monitor.alert.switch'),
                        align: 'center',
                        formatter: function (value, row, index) {
                            return elasticJobAlertTools(row);
                        },
                    },
                    {
                        title: i18n('sql.job.log.callback'),
                        align: 'center',
                        formatter: function(value, row, index) {
                            var actions = [];
                            actions.push('<a class="btn btn-primary btn-xs" href="javascript:void(0)" onclick="callbackElastic(\'' + row.id + '\')"><i class="fa fa-check"></i></a>');
                            return actions.join('');
                        }
                    }
                ]
            ]
        };
        $.table.init(options);
        elasticoptions = options;
    })


    /* sql检测调度任务告警显示 */
    function sqlJobAlertTools(row) {
        if (row.alertStatus === "1") {
            return '<i class=\"fa fa-toggle-off text-info fa-2x\" onclick="sqlJobAlertStart(\'' + row.id + '\')"></i> ';
        } else {
            return '<i class=\"fa fa-toggle-on text-info fa-2x\" onclick="sqlJobAlertStop(\'' + row.id + '\')"></i> ';
        }
    }

    /* sql检测告警-停用 */
    function sqlJobAlertStop(jobId) {
        $.operate.post(prefix + "/stopSqlJobAlert", {"id": jobId, "alertStatus": 1});
        checkAlert()
    }

    /* sql检测告警-启用 */
    function sqlJobAlertStart(jobId) {
        $.operate.post(prefix + "/startSqlJobAlert", {"id": jobId, "alertStatus": 0});
        checkAlert()
    }

    /* api检测调度任务告警显示 */
    function apiJobAlertTools(row) {
        if (row.alertStatus === "1") {
            return '<i class=\"fa fa-toggle-off text-info fa-2x\" onclick="apiJobAlertStart(\'' + row.id + '\')"></i> ';
        } else {
            return '<i class=\"fa fa-toggle-on text-info fa-2x\" onclick="apiJobAlertStop(\'' + row.id + '\')"></i> ';
        }
    }

    /* api检测告警-停用 */
    function apiJobAlertStop(jobId) {
        $.operate.post(prefix + "/stopApiJobAlert", {"id": jobId, "alertStatus": 1});
        checkAlert()
    }

    /* api检测告警-启用 */
    function apiJobAlertStart(jobId) {
        $.operate.post(prefix + "/startApiJobAlert", {"id": jobId, "alertStatus": 0});
        checkAlert()
    }

    /* elastic检测任务告警显示 */
    function elasticJobAlertTools(row) {
        if (row.alertStatus === "1") {
            return '<i class=\"fa fa-toggle-off text-info fa-2x\" onclick="elasticJobAlertStart(\'' + row.id + '\')"></i> ';
        } else {
            return '<i class=\"fa fa-toggle-on text-info fa-2x\" onclick="elasticJobAlertStop(\'' + row.id + '\')"></i> ';
        }
    }

    /*elastic检测任务告警-停用 */
    function elasticJobAlertStop(jobId) {
        $.operate.post(prefix + "/stopElasticJobAlert", {"id": jobId, "alertStatus": 1});
        checkAlert()
    }

    /* elastic检测任务告警-启用 */
    function elasticJobAlertStart(jobId) {
        $.operate.post(prefix + "/startElasticJobAlert", {"id": jobId, "alertStatus": 0});
        checkAlert()
    }

    function onClickSqlCell(field, value, row, $element){
        if (field !== 'callback' && field !== 'alertStatus'){
            $.operate.detail(row.id);
        }
    }

    function callbackSql(id){
        $.ajax({
            type:"GET",
            url:ctx + "monitor/sqlJobLog/callback/" + id,
            success : function(data) {
                if(data.code === 0){
                    $.modal.msgSuccess(i18n('sql.job.log.callback.success'));
                    $("#" + table.config['bootstrap-table-sql'].id).bootstrapTable('refresh',{silent: true});
                } else {
                    $.modal.msgWarning(i18n('sql.job.log.callback.failure'));
                }
            },
            error : function (){
                $.modal.msgError(i18n('common.sys.error'));
            }
        });
    }

    function callbackExport(id){
        $.ajax({
            type:"GET",
            url:ctx + "monitor/exportJobLog/callback/" + id,
            success : function(data) {
                if(data.code === 0){
                    $.modal.msgSuccess(i18n('sql.job.log.callback.success'));
                    $("#" + table.config['bootstrap-table-export'].id).bootstrapTable('refresh',{silent: true});
                } else {
                    $.modal.msgWarning(i18n('sql.job.log.callback.failure'));
                }
            },
            error : function (){
                $.modal.msgError(i18n('common.sys.error'));
            }
        });
    }

    function callbackApi(id){
        $.ajax({
            type:"GET",
            url:ctx + "monitor/apiJobLog/callback/" + id,
            success : function(data) {
                if(data.code === 0){
                    $.modal.msgSuccess(i18n('sql.job.log.callback.success'));
                    $("#" + table.config['bootstrap-table-api'].id).bootstrapTable('refresh',{silent: true});
                } else {
                    $.modal.msgWarning(i18n('sql.job.log.callback.failure'));
                }
            },
            error : function (){
                $.modal.msgError(i18n('common.sys.error'));
            }
        });
    }

    function callbackElastic(id){
        $.ajax({
            type:"GET",
            url:ctx + "monitor/elasticJobLog/callback/" + id,
            success : function(data) {
                if(data.code === 0){
                    $.modal.msgSuccess(i18n('sql.job.log.callback.success'));
                    $("#" + table.config['bootstrap-table-elastic'].id).bootstrapTable('refresh',{silent: true});
                } else {
                    $.modal.msgWarning(i18n('sql.job.log.callback.failure'));
                }
            },
            error : function (){
                $.modal.msgError(i18n('common.sys.error'));
            }
        });
    }

    $('#suspendRefreshSql').bootstrapSwitch({
        onText:"ON",
        offText:"OFF",
        onColor:"success",
        offColor:"danger",
        size:"mini",
        onSwitchChange:function(event,state){
            if(state===true){
                setupRefreshInterval(sqloptions,'bootstrap-table-sql','Sql')
            }else{
                clearInterval(sqloptions.autoRefreshFunction)
            }
        }
    });

    $("#selectTimeSql").change(function(){
        var state = $('#suspendRefreshSql').bootstrapSwitch('state');
        if (state) {
            clearInterval(sqloptions.autoRefreshFunction)
            setupRefreshInterval(sqloptions,'bootstrap-table-sql','Sql')
        }
    });

    $('#suspendRefreshElastic').bootstrapSwitch({
        onText:"ON",
        offText:"OFF",
        onColor:"success",
        offColor:"danger",
        size:"mini",
        onSwitchChange:function(event,state){
            if(state===true){
                setupRefreshInterval(elasticoptions,'bootstrap-table-elastic','Elastic')
            }else{
                clearInterval(elasticoptions.autoRefreshFunction)
            }
        }
    });

    $("#selectTimeElastic").change(function(){
        var state = $('#suspendRefreshElastic').bootstrapSwitch('state');
        if (state) {
            clearInterval(elasticoptions.autoRefreshFunction)
            setupRefreshInterval(elasticoptions,'bootstrap-table-elastic','Elastic')
        }
    });

    $('#suspendRefreshExport').bootstrapSwitch({
        onText:"ON",
        offText:"OFF",
        onColor:"success",
        offColor:"danger",
        size:"mini",
        onSwitchChange:function(event,state){
            if(state===true){
                setupRefreshInterval(exportoptions,'bootstrap-table-export','Export')
            }else{
                clearInterval(exportoptions.autoRefreshFunction)
            }
        }
    });

    $("#selectTimeExport").change(function(){
        var state = $('#suspendRefreshExport').bootstrapSwitch('state');
        if (state) {
            clearInterval(exportoptions.autoRefreshFunction)
            setupRefreshInterval(exportoptions,'bootstrap-table-export','Export')
        }
    });

    $('#suspendRefreshApi').bootstrapSwitch({
        onText:"ON",
        offText:"OFF",
        onColor:"success",
        offColor:"danger",
        size:"mini",
        onSwitchChange:function(event,state){
            if(state===true){
                setupRefreshInterval(apioptions,'bootstrap-table-api','Api')
            }else{
                clearInterval(apioptions.autoRefreshFunction)
            }
        }
    });

    $("#selectTimeApi").change(function(){
        var state = $('#suspendRefreshApi').bootstrapSwitch('state');
        if (state) {
            clearInterval(apioptions.autoRefreshFunction)
            setupRefreshInterval(apioptions,'bootstrap-table-api','Api')
        }
    });


    function setupRefreshInterval(op,tableId,which) {
        op.autoRefreshFunction = setInterval(() => {
            var state = $('#suspendRefresh' + which).bootstrapSwitch('state');
            if (!state) {
                return
            }
            $("#" + table.config[tableId].id).bootstrapTable('refresh',{silent: true});
        }, $('#selectTime' + which).val() * 1000)
    }

    function headerStyle(column) {
        return {
            '': {
                css: { background: '#3c8dbc','font-size': '100%',color:'white','font-weight': 'bolder' }
            }
        }[column.field]
    }

    $(function (){
        $('#suspendRefreshSql').bootstrapSwitch('state',true);
        $('#suspendRefreshElastic').bootstrapSwitch('state',true);
        $('#suspendRefreshApi').bootstrapSwitch('state',true);
        $('#suspendRefreshExport').bootstrapSwitch('state',true);
        switchOn()
    })
</script>
</body>
</html>